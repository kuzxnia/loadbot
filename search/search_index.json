{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"loadbot","text":""},{"location":"#introduction","title":"Introduction","text":"<p>Loadbot is a workload driver designed to simulate heavy loads on systems for performance testing and benchmarking purposes. It allows users to generate various types of workloads to stress-test their systems under different scenarios.</p> <p>This code, being an open-source project, is in its early development stage and likely contains various bugs. We welcome contributions from the community to help improve loadbot, make it more robust and reliable, and introduce new features.</p>"},{"location":"#how-to-install","title":"How to Install","text":"<p>Using Homebrew (MacOS/Linux)\ud83d\udca1</p> <pre><code>brew tap kuzxnia/loadbot\nbrew install loadbot\n</code></pre> <p>Alternatively, you can install loadbot from sources or run it directly in a Docker container. For more information on these installation methods, please refer to the documentation.</p>"},{"location":"#getting-started","title":"Getting started","text":"<p>After installing loadbot, you can quickly get started by following these steps:</p> <ol> <li> <p>Run LoadBot agent with your desired configuration using the command: <pre><code>loadbot start-agent -f config_file.json\n</code></pre></p> </li> <li> <p>Start the workload using the LoadBot client: <pre><code>loadbot start\n</code></pre></p> </li> <li> <p>Monitor the progress of the workload using the command: <pre><code>loadbot progress\n</code></pre></p> </li> <li> <p>To stop the workload, use the following command: <pre><code>loadbot stop\n</code></pre></p> </li> </ol> <p>For more information and detailed instructions, please refer to the quick start guide.</p>"},{"location":"#documentation","title":"Documentation","text":"<p>For detailed documentation on how to use loadbot and its available features, please refer to the official documentation.</p>"},{"location":"cli/","title":"Cli","text":""},{"location":"cli/#cli-usage","title":"CLI usage","text":"<pre><code>$ loadbot\nA command-line database workload driver\n\nUsage:\n  lbot [command]\n\nAgent Commands:\n  start-agent Start lbot-agent\n\nDriver Commands:\n  config      Config\n  progress    Watch stress test\n  start       Start stress test\n  stop        Stopping stress test\n\nAdditional Commands:\n  completion  Generate the autocompletion script for the specified shell\n  help        Help about any command\n\nFlags:\n  -u, --agent-uri string    loadbot agent uri (default: 127.0.0.1:1234) (default \"127.0.0.1:1234\")\n  -h, --help                help for lbot\n      --log-format string   log format, must be one of: json, fancy (default \"fancy\")\n      --log-level string    log level, must be one of: trace, debug, info, warn, error, fatal, panic (default \"info\")\n  -v, --version             version for lbot\n\nUse \"lbot [command] --help\" for more information about a command.\n</code></pre>"},{"location":"contributing/bug_reporting/","title":"Reporting a Bug","text":"<p>If you encounter any bugs or issues while using loadbot, we encourage you to report them so that we can address them promptly. Here's how you can report a bug effectively:</p> <ol> <li> <p>Check Existing Issues: Before reporting a new bug, please check the existing issues on the GitHub issue tracker to see if the bug has already been reported by someone else.</p> </li> <li> <p>Provide Details: When reporting a bug, provide as much detail as possible about the issue you're experiencing. Include information such as:</p> </li> <li>Steps to reproduce the bug</li> <li>Any error messages or logs you encountered</li> <li>Your operating system and loadbot version</li> <li>loadbot version: You can find this information by running <code>loadbot -v</code> in your terminal.</li> <li> <p>System version: Include information about your operating system version (e.g., macOS 10.15.7, Ubuntu 20.04).</p> </li> <li> <p>Create a New Issue: If you couldn't find an existing issue that matches your problem, create a new issue on the GitHub issue tracker. Be sure to give your issue a clear and descriptive title and include all relevant information in the description.</p> </li> <li> <p>Follow Up: Once you've reported the bug, feel free to follow up on the issue thread if you have additional information or if there are any updates on the bug.</p> </li> </ol> <p>By following these steps, you'll help us identify and address bugs in loadbot more efficiently, improving the overall quality of the tool for everyone.</p>"},{"location":"contributing/code_of_conduct/","title":"Contributor Covenant Code of Conduct","text":""},{"location":"contributing/code_of_conduct/#our-pledge","title":"Our Pledge","text":"<p>In the interest of fostering an open and welcoming environment, we as contributors and maintainers pledge to making participation in our project and our community a harassment-free experience for everyone, regardless of age, body size, disability, ethnicity, gender identity and expression, level of experience, education, socio-economic status, nationality, personal appearance, race, religion, or sexual identity and orientation.</p>"},{"location":"contributing/code_of_conduct/#our-standards","title":"Our Standards","text":"<p>Examples of behavior that contributes to creating a positive environment include:</p> <ul> <li>Using welcoming and inclusive language</li> <li>Being respectful of differing viewpoints and experiences</li> <li>Gracefully accepting constructive criticism</li> <li>Focusing on what is best for the community</li> <li>Showing empathy towards other community members</li> </ul> <p>Examples of unacceptable behavior by participants include:</p> <ul> <li>The use of sexualized language or imagery and unwelcome sexual attention or   advances</li> <li>Trolling, insulting/derogatory comments, and personal or political attacks</li> <li>Public or private harassment</li> <li>Publishing others' private information, such as a physical or electronic   address, without explicit permission</li> <li>Other conduct which could reasonably be considered inappropriate in a   professional setting</li> </ul>"},{"location":"contributing/code_of_conduct/#our-responsibilities","title":"Our Responsibilities","text":"<p>Project maintainers are responsible for clarifying the standards of acceptable behavior and are expected to take appropriate and fair corrective action in response to any instances of unacceptable behavior.</p> <p>Project maintainers have the right and responsibility to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, or to ban temporarily or permanently any contributor for other behaviors that they deem inappropriate, threatening, offensive, or harmful.</p>"},{"location":"contributing/code_of_conduct/#scope","title":"Scope","text":"<p>This Code of Conduct applies both within project spaces and in public spaces when an individual is representing the project or its community. Examples of representing a project or community include using an official project e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event. Representation of a project may be further defined and clarified by project maintainers.</p>"},{"location":"contributing/code_of_conduct/#enforcement","title":"Enforcement","text":"<p>Instances of abusive, harassing, or otherwise unacceptable behavior may be reported by contacting the project team at {{ email }}. All complaints will be reviewed and investigated and will result in a response that is deemed necessary and appropriate to the circumstances. The project team is obligated to maintain confidentiality with regard to the reporter of an incident. Further details of specific enforcement policies may be posted separately.</p> <p>Project maintainers who do not follow or enforce the Code of Conduct in good faith may face temporary or permanent repercussions as determined by other members of the project's leadership.</p>"},{"location":"contributing/code_of_conduct/#attribution","title":"Attribution","text":"<p>This Code of Conduct is adapted from the Contributor Covenant, version 1.4, available at https://www.contributor-covenant.org/version/1/4/code-of-conduct.html</p>"},{"location":"contributing/development/","title":"Development","text":"<p>If you're interested in contributing to the development of loadbot, here are a few things you'll need to set up:</p> <ol> <li> <p>Install Golang: loadbot is written in Go, so you'll need to have Go installed on your system. You can download and install it from the official Go website.</p> </li> <li> <p>Install GoReleaser: GoReleaser is used for releasing Go projects. You can install it using Go itself:    <pre><code>go install github.com/goreleaser/goreleaser@latest\n</code></pre></p> </li> </ol> <p>This section outlines the basic requirements for setting up your development environment for loadbot. Feel free to add more details or specific instructions as needed.</p>"},{"location":"contributing/known_issues/","title":"Known issues","text":"<ul> <li> <p>srv not working with some DNS servers - golng 1.13+ issue see this and this</p> <p>Old versions of kube-dns and the native DNS resolver (systemd-resolver) on Ubuntu 18.04 are known to be non-compliant in this manner. </p> </li> </ul>"},{"location":"contributing/license/","title":"License","text":"<pre><code>                             Apache License\n                       Version 2.0, January 2004\n                    http://www.apache.org/licenses/\n</code></pre> <p>TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION</p> <ol> <li> <p>Definitions.</p> <p>\"License\" shall mean the terms and conditions for use, reproduction,   and distribution as defined by Sections 1 through 9 of this document.</p> <p>\"Licensor\" shall mean the copyright owner or entity authorized by   the copyright owner that is granting the License.</p> <p>\"Legal Entity\" shall mean the union of the acting entity and all   other entities that control, are controlled by, or are under common   control with that entity. For the purposes of this definition,   \"control\" means (i) the power, direct or indirect, to cause the   direction or management of such entity, whether by contract or   otherwise, or (ii) ownership of fifty percent (50%) or more of the   outstanding shares, or (iii) beneficial ownership of such entity.</p> <p>\"You\" (or \"Your\") shall mean an individual or Legal Entity   exercising permissions granted by this License.</p> <p>\"Source\" form shall mean the preferred form for making modifications,   including but not limited to software source code, documentation   source, and configuration files.</p> <p>\"Object\" form shall mean any form resulting from mechanical   transformation or translation of a Source form, including but   not limited to compiled object code, generated documentation,   and conversions to other media types.</p> <p>\"Work\" shall mean the work of authorship, whether in Source or   Object form, made available under the License, as indicated by a   copyright notice that is included in or attached to the work   (an example is provided in the Appendix below).</p> <p>\"Derivative Works\" shall mean any work, whether in Source or Object   form, that is based on (or derived from) the Work and for which the   editorial revisions, annotations, elaborations, or other modifications   represent, as a whole, an original work of authorship. For the purposes   of this License, Derivative Works shall not include works that remain   separable from, or merely link (or bind by name) to the interfaces of,   the Work and Derivative Works thereof.</p> <p>\"Contribution\" shall mean any work of authorship, including   the original version of the Work and any modifications or additions   to that Work or Derivative Works thereof, that is intentionally   submitted to Licensor for inclusion in the Work by the copyright owner   or by an individual or Legal Entity authorized to submit on behalf of   the copyright owner. For the purposes of this definition, \"submitted\"   means any form of electronic, verbal, or written communication sent   to the Licensor or its representatives, including but not limited to   communication on electronic mailing lists, source code control systems,   and issue tracking systems that are managed by, or on behalf of, the   Licensor for the purpose of discussing and improving the Work, but   excluding communication that is conspicuously marked or otherwise   designated in writing by the copyright owner as \"Not a Contribution.\"</p> <p>\"Contributor\" shall mean Licensor and any individual or Legal Entity   on behalf of whom a Contribution has been received by Licensor and   subsequently incorporated within the Work.</p> </li> <li> <p>Grant of Copyright License. Subject to the terms and conditions of       this License, each Contributor hereby grants to You a perpetual,       worldwide, non-exclusive, no-charge, royalty-free, irrevocable       copyright license to reproduce, prepare Derivative Works of,       publicly display, publicly perform, sublicense, and distribute the       Work and such Derivative Works in Source or Object form.</p> </li> <li> <p>Grant of Patent License. Subject to the terms and conditions of       this License, each Contributor hereby grants to You a perpetual,       worldwide, non-exclusive, no-charge, royalty-free, irrevocable       (except as stated in this section) patent license to make, have made,       use, offer to sell, sell, import, and otherwise transfer the Work,       where such license applies only to those patent claims licensable       by such Contributor that are necessarily infringed by their       Contribution(s) alone or by combination of their Contribution(s)       with the Work to which such Contribution(s) was submitted. If You       institute patent litigation against any entity (including a       cross-claim or counterclaim in a lawsuit) alleging that the Work       or a Contribution incorporated within the Work constitutes direct       or contributory patent infringement, then any patent licenses       granted to You under this License for that Work shall terminate       as of the date such litigation is filed.</p> </li> <li> <p>Redistribution. You may reproduce and distribute copies of the       Work or Derivative Works thereof in any medium, with or without       modifications, and in Source or Object form, provided that You       meet the following conditions:</p> <p>(a) You must give any other recipients of the Work or       Derivative Works a copy of this License; and</p> <p>(b) You must cause any modified files to carry prominent notices       stating that You changed the files; and</p> <p>(c) You must retain, in the Source form of any Derivative Works       that You distribute, all copyright, patent, trademark, and       attribution notices from the Source form of the Work,       excluding those notices that do not pertain to any part of       the Derivative Works; and</p> <p>(d) If the Work includes a \"NOTICE\" text file as part of its       distribution, then any Derivative Works that You distribute must       include a readable copy of the attribution notices contained       within such NOTICE file, excluding those notices that do not       pertain to any part of the Derivative Works, in at least one       of the following places: within a NOTICE text file distributed       as part of the Derivative Works; within the Source form or       documentation, if provided along with the Derivative Works; or,       within a display generated by the Derivative Works, if and       wherever such third-party notices normally appear. The contents       of the NOTICE file are for informational purposes only and       do not modify the License. You may add Your own attribution       notices within Derivative Works that You distribute, alongside       or as an addendum to the NOTICE text from the Work, provided       that such additional attribution notices cannot be construed       as modifying the License.</p> <p>You may add Your own copyright statement to Your modifications and   may provide additional or different license terms and conditions   for use, reproduction, or distribution of Your modifications, or   for any such Derivative Works as a whole, provided Your use,   reproduction, and distribution of the Work otherwise complies with   the conditions stated in this License.</p> </li> <li> <p>Submission of Contributions. Unless You explicitly state otherwise,       any Contribution intentionally submitted for inclusion in the Work       by You to the Licensor shall be under the terms and conditions of       this License, without any additional terms or conditions.       Notwithstanding the above, nothing herein shall supersede or modify       the terms of any separate license agreement you may have executed       with Licensor regarding such Contributions.</p> </li> <li> <p>Trademarks. This License does not grant permission to use the trade       names, trademarks, service marks, or product names of the Licensor,       except as required for reasonable and customary use in describing the       origin of the Work and reproducing the content of the NOTICE file.</p> </li> <li> <p>Disclaimer of Warranty. Unless required by applicable law or       agreed to in writing, Licensor provides the Work (and each       Contributor provides its Contributions) on an \"AS IS\" BASIS,       WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or       implied, including, without limitation, any warranties or conditions       of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A       PARTICULAR PURPOSE. You are solely responsible for determining the       appropriateness of using or redistributing the Work and assume any       risks associated with Your exercise of permissions under this License.</p> </li> <li> <p>Limitation of Liability. In no event and under no legal theory,       whether in tort (including negligence), contract, or otherwise,       unless required by applicable law (such as deliberate and grossly       negligent acts) or agreed to in writing, shall any Contributor be       liable to You for damages, including any direct, indirect, special,       incidental, or consequential damages of any character arising as a       result of this License or out of the use or inability to use the       Work (including but not limited to damages for loss of goodwill,       work stoppage, computer failure or malfunction, or any and all       other commercial damages or losses), even if such Contributor       has been advised of the possibility of such damages.</p> </li> <li> <p>Accepting Warranty or Additional Liability. While redistributing       the Work or Derivative Works thereof, You may choose to offer,       and charge a fee for, acceptance of support, warranty, indemnity,       or other liability obligations and/or rights consistent with this       License. However, in accepting such obligations, You may act only       on Your own behalf and on Your sole responsibility, not on behalf       of any other Contributor, and only if You agree to indemnify,       defend, and hold each Contributor harmless for any liability       incurred by, or claims asserted against, such Contributor by reason       of your accepting any such warranty or additional liability.</p> </li> </ol> <p>END OF TERMS AND CONDITIONS</p> <p>APPENDIX: How to apply the Apache License to your work.</p> <pre><code>  To apply the Apache License to your work, attach the following\n  boilerplate notice, with the fields enclosed by brackets \"{}\"\n  replaced with your own identifying information. (Don't include\n  the brackets!)  The text should be enclosed in the appropriate\n  comment syntax for the file format. We also recommend that a\n  file or class name and description of purpose be included on the\n  same \"printed page\" as the copyright notice for easier\n  identification within third-party archives.\n</code></pre> <p>Copyright 2022 Utku Ozdemir</p> <p>Licensed under the Apache License, Version 2.0 (the \"License\");    you may not use this file except in compliance with the License.    You may obtain a copy of the License at</p> <pre><code>   http://www.apache.org/licenses/LICENSE-2.0\n</code></pre> <p>Unless required by applicable law or agreed to in writing, software    distributed under the License is distributed on an \"AS IS\" BASIS,    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.    See the License for the specific language governing permissions and    limitations under the License.</p>"},{"location":"getting_started/install/","title":"Installation","text":""},{"location":"getting_started/install/#using-homebrew-macoslinux","title":"Using Homebrew (MacOS/Linux)","text":"<p>If you have homebrew, the installation is as simple as: <pre><code>brew tap kuzxnia/loadbot\nbrew install loadbot\n</code></pre></p>"},{"location":"getting_started/install/#running-directly-in-docker-container","title":"Running directly in Docker container","text":"<p>Alternatively, you can use the official Docker images that come with the <code>loadbot</code> binary pre-installed: <pre><code>docker run --rm kuzxnia/loadbot --help\n</code></pre></p>"},{"location":"getting_started/install/#by-downloading-the-binaries-macoslinux","title":"By downloading the binaries (MacOS/Linux)","text":"<ol> <li>Go to the releases and download    the latest release archive for your platform.</li> <li>Extract the archive.</li> <li>Move the binary to somewhere in your <code>PATH</code>.</li> </ol> <p>Sample steps for MacOS: <pre><code>$ VERSION=&lt;VERSION_TAG&gt;\n$ wget https://github.com/kuzxnia/loadbot/releases/download/${VERSION}/loadbot_${VERSION}_darwin_x86_64.tar.gz\n$ tar -xvzf loadbot_${VERSION}_darwin_x86_64.tar.gz\n$ mv loadbot /usr/local/bin\n$ loadbot --help\n</code></pre></p>"},{"location":"getting_started/k8s-orchiestration/","title":"K8S","text":"<p>You can run your workload locally, from remote servers, or directly on a Kubernetes cluster. However, deploying your workload on Kubernetes offers several advantages, including:</p> <ul> <li> <p>Easy Scaling: Kubernetes enables you to scale your workload effortlessly by adjusting the number of replicas or utilizing features like Horizontal Pod Autoscaler.</p> </li> <li> <p>Resource Management: Kubernetes provides robust resource management capabilities, allowing you to efficiently allocate and manage resources such as CPU and memory for your workload. You can overwrite default values using <code>helm-set</code> flag.</p> </li> </ul>"},{"location":"getting_started/k8s-orchiestration/#installation","title":"Installation","text":"<p>To install your workload using Loadbot on a Kubernetes cluster, you can use the following command:</p> <pre><code>loadbot install \\\n    --context dev \\\n    --namespace default \\\n    --helm-set workload.replicas=2 \\\n    --workload-config config.json \\\n    myworkload \n</code></pre>"},{"location":"getting_started/k8s-orchiestration/#uninstall","title":"Uninstall","text":"<p>To uninstall your workload from the Kubernetes cluster, you can use the following command:</p> <pre><code>loadbot uninstall \\\n    --context dev \\\n    --namespace default \\\n    myworkload \n</code></pre>"},{"location":"getting_started/k8s-orchiestration/#upgrade","title":"Upgrade","text":"<p>To upgrade your workload on the Kubernetes cluster, you can use the following command:</p> <pre><code>loadbot upgrade \\\n    --context dev \\\n    --namespace default \\\n    --helm-set workload.replicas=2 \\\n    --workload-config config.json \\\n    myworkload \n</code></pre>"},{"location":"getting_started/k8s-orchiestration/#list","title":"List","text":"<p>To list the workloads deployed on the Kubernetes cluster, you can use the following command:</p> <pre><code>loadbot list --context dev --namespace default\n</code></pre>"},{"location":"getting_started/quick-start/","title":"Quick Start","text":"<p>After installing loadbot, you can quickly get started by following these steps:</p> <ol> <li> <p>Run loadbot agent with your desired configuration using the command: <pre><code>loadbot start-agent -f config_file.json\n</code></pre></p> </li> <li> <p>Start and watch the workload using the loadbot client: <pre><code>loadbot start --progress\nJob \"My first job\" |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 30/30S 50RPS 1509REQ\n</code></pre></p> </li> <li> <p>To stop the workload, use the following command: <pre><code>loadbot stop\n</code></pre></p> </li> </ol>"},{"location":"getting_started/quick-start/#example-config-file","title":"Example config file","text":"<p>For more information on defining jobs and schemas, visit the configuration section of the documentation.</p> <pre><code>{\n  \"connection_string\": \"mongodb://myadmin:abc123@127.0.0.1:27017\",\n  \"jobs\": [\n    {  // start on empty collection - fresh start \n      \"type\": \"drop_collection\",\n      \"database\": \"tmp-kuzxnia-showcase-db\",\n      \"collection\": \"tmp-kuzxnia-showcase-col\",\n      \"operations\": 1\n    },\n    {\n      \"name\": \"Workload 20s max throughput\",\n      \"type\": \"write\",\n      \"database\": \"tmp-kuzxnia-showcase-db\",\n      \"collection\": \"tmp-kuzxnia-showcase-col\",\n      \"data_size\": 200,\n      \"connections\": 100,\n      \"duration\": \"20s\",\n    },\n    {  // give little rest to db\n      \"type\": \"sleep\",\n      \"duration\": \"5s\",\n      \"format\": \"simple\"\n    },\n    {\n      \"name\": \"Workload 1_000_000 elements with pace 10K rps\",\n      \"type\": \"write\",\n      \"batch_size\": 100,\n      \"database\": \"tmp-kuzxnia-showcase-db\",\n      \"collection\": \"tmp-kuzxnia-showcase-col\",\n      \"data_size\": 100,\n      \"connections\": 200,\n      \"pace\": 10000,\n      \"operations\": 1000000,\n    }\n}\n</code></pre>"},{"location":"setup/","title":"Configuration file","text":"<p>Due to the limited functionalities of the CLI, in order to fully harness the capabilities of this tool, it is advisable to utilize a configuration file.</p> <p>Note: If you want to use config file with docker you need to mount volume with config file.</p> <p>Example file:</p> <pre><code>{\n  \"connection_string\": \"mongodb://localhost:27017\",\n  \"debug\": true,\n  \"jobs\": [\n    {\n      \"name\": \"Write 100c 1k ops\",\n      \"type\": \"write\",\n      \"schema\": \"user_schema\",\n      \"connections\": 100,\n      \"operations\": 1000,\n    },\n    {\n      \"name\": \"Dummy job name/ read 30s 100rps\",\n      \"type\": \"read\",\n      \"schema\": \"user_schema\",\n      \"connections\": 100,\n      \"pace\": 100,\n      \"duration\": \"30s\",\n      \"filter\": {\n          \"special_name\": \"#special_name\"\n      }\n    }\n  ],\n  \"schemas\": [\n    {\n      \"name\": \"user_schema\",\n      \"database\": \"load_test\",\n      \"collection\": \"load_test\",\n      \"schema\": {\n        \"_id\": \"#_id\",\n        \"special_name\": \"#string\",\n        \"lastname\": \"#string\"\n      },\n      \"save\": [\n        \"special_name\"  // will be avaliable in job.filter under \"#special_name\"\n      ]\n    },\n  ]\n}\n</code></pre>"},{"location":"setup/agent/","title":"Agent configuration","text":"<p>The agent configuration allows you to customize various parameters for the behavior of the agent. Below is an example file illustrating the structure and available fields for configuring the agent:</p> <p>Note: You can configure the agent both from the command line interface and from a configuration file.</p>"},{"location":"setup/agent/#cli-usage","title":"CLI Usage","text":"<p>To start the loadbot agent, use the following command:</p> <pre><code>Usage:\n  loadbot start-agent [flags]\n\nFlags:\n  -f, --config-file string                     Config file for loadbot-agent\n  -h, --help                                   help for start-agent\n      --metrics_export_interval_seconds uint   Prometheus export push interval\n      --metrics_export_port string             Expose metrics on port instead pushing to prometheus\n      --metrics_export_url string              Prometheus export url used for pushing metrics\n  -n, --name string                            Agent name\n  -p, --port string                            Agent port\n      --stdin                                  Provide configuration from stdin.\n</code></pre> <p>Note: Configurations specified from the command line interface will overwrite those from the configuration file.</p>"},{"location":"setup/agent/#configuration-file","title":"Configuration file","text":"<p>In the configuration file, you're able to configure both workloads and the agent, whereas via the command-line interface, you can solely configure the agent.</p> <pre><code>{\n    \"agent\": {\n        \"name\": \"mongo 6.0.8 workload\",\n        \"port\": \"1234\",\n        \"metrics_export_url\": \"http://victoria-metrics:8428/api/v1/import/prometheus\",\n        \"metrics_export_interval_seconds\": 10,\n        \"metrics_export_port\": \"9090\",\n    }\n}\n</code></pre> <p>Note:  The agent configuration is only applied when the agent is started. It cannot be changed at runtime using commands such as <code>loadbot config</code>.</p>"},{"location":"setup/agent/#agent-fields","title":"Agent Fields","text":"<ul> <li>name (string, optional): Specifies the name of the agent. This field is used as a label in the metrics exporter. Useful when exporting metrics from multiple agents.</li> <li>port (string, optional): Specifies the port on which the agent listens for incoming connections.</li> <li>metrics_export_url (string, optional): If set, metrics will be pushed to the specified endpoint in the Prometheus standard format.</li> <li>metrics_export_interval_seconds (integer, optional): Specifies the interval (in seconds) at which metrics are pushed to the export endpoint.</li> <li>metrics_export_port (string, optional): If set, metrics will be accessible on the provided port.</li> </ul>"},{"location":"setup/job/","title":"Jobs","text":""},{"location":"setup/job/#jobs-fields","title":"Jobs fields:","text":"<ul> <li><code>name</code>(string, optional) - job name</li> <li><code>type</code>(enum <code>write|bulk_write|read|update|create_index|drop_collection|sleep</code>) - operation type</li> <li><code>template</code>(string) - schema name, if you will not provide schema data will be inserted in <code>{'data': &lt;generate_data&gt;}</code> format</li> <li><code>database</code>(string, required if schema is not set) - database name</li> <li><code>schema</code>(string, optional) - string foreign-key to schemas list</li> <li><code>filter</code>(string, required for read and update) - filter schema</li> <li><code>indexes</code>(list, optional) - list of indexes to create (only for type \"create_index\") </li> <li><code>collection</code>(string, required if schema is not set) - collection name</li> <li><code>connection</code>(unsigned int) - number of concurrent connections, number is not limited to physical threads number</li> <li><code>data_size</code>(unsigned int) - data size inserted (currently only works for default schema)</li> <li><code>batch_size</code>(unsigned int) - insert batch size (only applicable for <code>bulk_write</code> job type)</li> <li><code>duration</code>(string) - duration time ex. 1h, 15m, 10s</li> <li><code>operations</code>(unsigned int) - number of requests to perform, ex. 100 reads, 100 bulk_writes</li> <li><code>timeout</code>(string) - connection timeout ex. 1h, 15m, 10s</li> </ul>"},{"location":"setup/job/#defining-jobs","title":"Defining Jobs","text":"<p>Example write with schema 100ops</p> <pre><code>{\n  \"name\": \"insert with schema\",\n  \"type\": \"write\",\n  \"schema\": \"user_schema\",\n  \"connections\": 10,\n  \"operations\": 100\n}\n</code></pre>"},{"location":"setup/job/#write-without-schema-20s","title":"Write without schema 20s","text":"<pre><code>{\n  \"name\": \"insert without schema\",\n  \"type\": \"write\",\n  \"database\": \"load_test\",\n  \"collection\": \"load_test\",\n  \"connections\": 10,\n  \"data_size\": 100,\n  \"duration\": \"20s\",\n  \"timeout\": \"1s\"\n}\n</code></pre>"},{"location":"setup/job/#read-with-schema-20s","title":"Read with schema 20s","text":"<pre><code>{\n  \"name\": \"read with schema\",\n  \"type\": \"read\",\n  \"schema\": \"user_schema\",\n  \"connections\": 10,\n  \"operations\": 100,\n  \"filter\": {\n    \"user_name\": \"#user_name\",\n    \"name\": \"#generate_value\"  // here you can use remember/saved value as well as generated one\n  }\n}\n</code></pre>"},{"location":"setup/job/#let-the-database-rest","title":"Let the database rest","text":"<pre><code>{\n  \"type\": \"sleep\",\n  \"duration\": \"5s\"\n}\n</code></pre>"},{"location":"setup/job/#drop-collection","title":"Drop collection","text":"<p><pre><code>{\n  \"type\": \"drop_collection\",\n  \"database\": \"load_test\",\n  \"collection\": \"load_test\",\n  \"operations\": 1\n}\n</code></pre> or with schema <pre><code>{\n  \"type\": \"drop_collection\",\n  \"schema\": \"example_schema\",\n  \"operations\": 1\n}\n</code></pre></p>"},{"location":"setup/metrics/","title":"Prometheus metrics export","text":"<p>The metrics exporting feature enables you to monitor and analyze various metrics related to your workload. Below, we detail the key aspects of this feature:</p>"},{"location":"setup/metrics/#library-dependency","title":"Library Dependency","text":"<p>Our project utilizes the lightweight library github.com/VictoriaMetrics/metrics as an alternative to github.com/prometheus/client_golang. This library facilitates efficient handling and exporting of metrics for monitoring purposes.</p>"},{"location":"setup/metrics/#exporting-strategies","title":"Exporting Strategies","text":"<p>You have the flexibility to choose between two strategies for exporting metrics: pull or push.</p>"},{"location":"setup/metrics/#push-strategy","title":"Push Strategy:","text":"<p>With this strategy, the tool pushes metrics to the provided URL at the specified interval.</p> <p>Configure the agent using the following flags:</p> <ul> <li>metrics_export_url: Specifies the URL where metrics will be pushed.</li> <li>metrics_export_interval_seconds: Defines the interval (in seconds) for pushing metrics.</li> </ul>"},{"location":"setup/metrics/#pull-strategy","title":"Pull Strategy:","text":"<p>With this strategy, external app pull metrics from us and put them into Prometheus.</p> <p>Configure the agent using the following flags: - metrics_export_url: Configure the agent to expose an HTTP server on the provided port.</p>"},{"location":"setup/metrics/#metrics-selection","title":"Metrics Selection","text":"<p>The metrics available for monitoring encompass both system-level metrics and custom metrics related to your workloads. Here are some popular metrics from a Go application's perspective:</p>"},{"location":"setup/metrics/#system-metrics","title":"System Metrics:","text":"<ul> <li><code>go_goroutines</code></li> <li><code>go_threads</code></li> <li><code>go_memstats_alloc_bytes</code></li> <li><code>go_memstats_heap_inuse_bytes</code></li> <li><code>go_memstats_alloc_bytes_total</code></li> <li><code>process_resident_memory_bytes</code></li> </ul>"},{"location":"setup/metrics/#custom-workload-metrics","title":"Custom Workload Metrics:","text":"<ul> <li><code>requests_total</code></li> <li><code>requests_error</code></li> <li><code>requests_duration_seconds</code></li> </ul>"},{"location":"setup/metrics/#labels-for-querying","title":"Labels for Querying","text":"<p>When querying custom workload metrics, you can utilize labels to specify job-related information:</p> <pre><code>{job=\"job_name_here\", job_uuid=\"auto_generate_uuid\", job_type=\"write|bulk_write|read|update...\" agent=\"agent_name_here\"}\n</code></pre>"},{"location":"setup/metrics/#example-query","title":"Example query:","text":"<pre><code>requests_total{job=\"workload 1\", agent=\"186.12.9.19\"}\n</code></pre> <p>The <code>job_uuid</code> label distinguishes between different job runs/attempts, allowing you to track and analyze performance across multiple executions of the same job. Additionally, all metrics are labeled with the <code>name of the agent</code>, enabling you to differentiate metrics coming from different agents.</p>"},{"location":"setup/metrics/#additional-resources","title":"Additional Resources","text":"<p>Metrics have been extracted from VictoriaMetrics sources. For more in-depth information about VictoriaMetrics, you can refer to the following article: VictoriaMetrics: Creating the Best Remote Storage for Prometheus.</p> <p>You can also refer to an excellent article discussing Prometheus metrics in Go, which can provide further insights (Prometheus Go Metrics)[https://povilasv.me/prometheus-go-metrics/].</p> <p>Example Grafana Golang dashboard template.</p>"},{"location":"setup/other/","title":"Other features","text":"<ul> <li>config file JSON standardization - comments and trailing commas support ex. <pre><code>{\n    \"jobs\": [\n        {\n          \"type\": \"drop_collection\",\n          \"database\": \"load_test\",\n          \"collection\": \"load_test\",\n          \"operations\": 1\n        },\n        /*{\n          \"type\": \"sleep\",\n          \"duration\": \"5s\",\n          \"format\": \"simple\"\n        },*/\n    ]\n}\n</code></pre></li> </ul> <p>Note: If you don't provide the requests amount or duration limit program will continue running  indefinitely unless it is manually stopped by pressing <code>ctrl-c</code>. </p>"},{"location":"setup/schema/","title":"Defining schemas","text":""},{"location":"setup/schema/#schema-fields","title":"Schema fields","text":"<ul> <li><code>name</code> - unique name, used in jobs (see job.schema) for determining which template use</li> <li><code>database</code> - database name</li> <li><code>collection</code> - collection name</li> <li><code>schema</code> - actual document template</li> </ul>"},{"location":"setup/schema/#schema-document-template-fields","title":"Schema document template fields","text":"<p>General - <code>#id</code>  - <code>#string</code> - <code>#word</code></p> <p>Internet - <code>#email</code> - <code>#username</code> - <code>#password</code></p> <p>Person - <code>#name</code> - <code>#first_name</code> - <code>#first_name_male</code> - <code>#first_name_female</code> - <code>#last_name</code> - <code>#title_male</code> - <code>#title_female</code> - <code>#phone_number</code></p>"}]}